<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Chapter4 网络层 | 水货不水</title><meta name="author" content="Fat1ger"><meta name="copyright" content="Fat1ger"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="referrer" content="no-referrer"><meta name="description" content="Chapter4 网络层LINUX？ 本章重点1、IP数据报的格式和分片 2、IP地址的表示和分类分配、子网掩码、地址有效性、广播地址 3、子网划分 4、CIDR路由聚合 5、ARP协议和ICMP协议 6、路由表、路由器的工作原理 7、RIP协议和OSPF协议 8、网络层的综合设计和应用 网络层的功能网络层的主要任务是将分组从源主机经过多个网络和多段链路传输到目的主机。  只提供简单灵活的，无连接">
<meta property="og:type" content="article">
<meta property="og:title" content="Chapter4 网络层">
<meta property="og:url" content="http://seafoodfat1ger.github.io/2025/05/27/network/Chapter4/index.html">
<meta property="og:site_name" content="水货不水">
<meta property="og:description" content="Chapter4 网络层LINUX？ 本章重点1、IP数据报的格式和分片 2、IP地址的表示和分类分配、子网掩码、地址有效性、广播地址 3、子网划分 4、CIDR路由聚合 5、ARP协议和ICMP协议 6、路由表、路由器的工作原理 7、RIP协议和OSPF协议 8、网络层的综合设计和应用 网络层的功能网络层的主要任务是将分组从源主机经过多个网络和多段链路传输到目的主机。  只提供简单灵活的，无连接">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://seafoodfat1ger.github.io/img/Background.jpg">
<meta property="article:published_time" content="2025-05-27T06:30:14.000Z">
<meta property="article:modified_time" content="2025-06-06T14:03:42.942Z">
<meta property="article:author" content="Fat1ger">
<meta property="article:tag" content="compter_network">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://seafoodfat1ger.github.io/img/Background.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://seafoodfat1ger.github.io/2025/05/27/network/Chapter4/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Chapter4 网络层',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-06-06 22:03:42'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" href="/css/custom.css" media="defer" onload="this.media='all'"><link  rel="stylesheet" href="//at.alicdn.com/t/c/font_4046602_w4e3ixuz8in.css" media="defer" onload="this.media='all'"><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-double-row-display@1.00/cardlistpost.min.css"/>
<style>#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags:before {content:"\A";
  white-space: pre;}#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags > .article-meta__separator{display:none}</style>
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.1.1"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()
  window.addEventListener('load',() => { preloader.endLoading() })

  if (true) {
    document.addEventListener('pjax:send', () => { preloader.initLoading() })
    document.addEventListener('pjax:complete', () => { preloader.endLoading() })
  }
})()</script><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/toux.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">38</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">5</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">5</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw iconfont  icon-shouye"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw iconfont icon-pengyouquanwenzhang"></i><span> 文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw iconfont icon-guidang"></i><span> 归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw iconfont icon-biaoqian"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw iconfont icon-fenlei"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw iconfont icon-xiuxian"></i><span> 休闲</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/movies/"><i class="fa-fw iconfont icon-dianying"></i><span> 影院</span></a></li><li><a class="site-page child" href="/games/"><i class="fa-fw iconfont icon-youxi"></i><span> 游戏</span></a></li></ul></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw iconfont icon-gongjuxiang"></i><span> 工具箱</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/gallery/"><i class="fa-fw iconfont icon-xiangce"></i><span> 画廊</span></a></li><li><a class="site-page child" href="/tool/"><i class="fa-fw iconfont icon-gongjuxiang"></i><span> 工具</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/comments/"><i class="fa-fw iconfont icon-liuyanban"></i><span> 留言版</span></a></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fas fa-link"></i><span> 友链</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> 良师益友</span></a></li></ul></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw iconfont icon-gerenjianli"></i><span> 个人</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/about/"><i class="fa-fw iconfont icon-guanyu-banben"></i><span> 关于</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/Background.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="水货不水"><span class="site-name">水货不水</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw iconfont  icon-shouye"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw iconfont icon-pengyouquanwenzhang"></i><span> 文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/archives/"><i class="fa-fw iconfont icon-guidang"></i><span> 归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw iconfont icon-biaoqian"></i><span> 标签</span></a></li><li><a class="site-page child" href="/categories/"><i class="fa-fw iconfont icon-fenlei"></i><span> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw iconfont icon-xiuxian"></i><span> 休闲</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/movies/"><i class="fa-fw iconfont icon-dianying"></i><span> 影院</span></a></li><li><a class="site-page child" href="/games/"><i class="fa-fw iconfont icon-youxi"></i><span> 游戏</span></a></li></ul></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw iconfont icon-gongjuxiang"></i><span> 工具箱</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/gallery/"><i class="fa-fw iconfont icon-xiangce"></i><span> 画廊</span></a></li><li><a class="site-page child" href="/tool/"><i class="fa-fw iconfont icon-gongjuxiang"></i><span> 工具</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/comments/"><i class="fa-fw iconfont icon-liuyanban"></i><span> 留言版</span></a></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw fas fa-link"></i><span> 友链</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/link/"><i class="fa-fw fas fa-link"></i><span> 良师益友</span></a></li></ul></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw iconfont icon-gerenjianli"></i><span> 个人</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/about/"><i class="fa-fw iconfont icon-guanyu-banben"></i><span> 关于</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Chapter4 网络层</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-05-27T06:30:14.000Z" title="发表于 2025-05-27 14:30:14">2025-05-27</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-06-06T14:03:42.942Z" title="更新于 2025-06-06 22:03:42">2025-06-06</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/compter-network/">compter_network</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Chapter4 网络层"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="Chapter4-网络层"><a href="#Chapter4-网络层" class="headerlink" title="Chapter4 网络层"></a>Chapter4 网络层</h1><h2 id="LINUX？"><a href="#LINUX？" class="headerlink" title="LINUX？"></a>LINUX？</h2><p><img src="C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20250530171629502.png" alt="image-20250530171629502"></p>
<h2 id="本章重点"><a href="#本章重点" class="headerlink" title="本章重点"></a>本章重点</h2><p>1、IP数据报的格式和分片</p>
<p>2、IP地址的表示和分类分配、子网掩码、地址有效性、广播地址</p>
<p>3、子网划分</p>
<p>4、CIDR路由聚合</p>
<p>5、ARP协议和ICMP协议</p>
<p>6、路由表、路由器的工作原理</p>
<p>7、RIP协议和OSPF协议</p>
<p>8、网络层的综合设计和应用</p>
<h2 id="网络层的功能"><a href="#网络层的功能" class="headerlink" title="网络层的功能"></a>网络层的功能</h2><p>网络层的主要任务是将分组从源主机经过多个网络和多段链路传输到目的主机。</p>
<ul>
<li>只提供<code>简单灵活的</code>，<code>无连接的</code>，<code>尽最大努力交付</code>的数据报服务</li>
<li>可能<code>出错</code>，<code>丢失</code>，<code>重复</code>，<code>失序或超时</code>，可靠通信由更高层的 <strong><code>传输层</code></strong> 来完成</li>
<li>网络造价<code>大幅降低</code>，运行方式<code>灵活</code>，能够适用多种应用</li>
</ul>
<blockquote>
<p>丢弃 IP 数据报的情况是:</p>
<p>路由器检测出首部检验和有错误</p>
<p>因为网络中通信量过大,路由器或目的主机中的缓存已无空闲空间。</p>
</blockquote>
<h3 id="异构网络互联"><a href="#异构网络互联" class="headerlink" title="异构网络互联"></a>异构网络互联</h3><p>异构网络是数据链路层和物理层至少有一个不同</p>
<ul>
<li>网络互联：两个以上的计算机网络，通过一定的方法，用一些中间设备（又称<strong>中继设备</strong>），互相连接起来，以构成更大的网络系统。</li>
<li>中继系统分类：<ul>
<li><code>物理层</code>：转发器，集线器。</li>
<li><code>数据链路层</code>：网桥或交换机。</li>
<li><code>网络层</code>：路由器</li>
<li><code>网络层以上</code>：网关</li>
</ul>
</li>
</ul>
<blockquote>
<p>网络互联通常指用<code>路由器</code>进行网络互联和路由选择。</p>
<p>路由器是一台专用计算机，用于在互联网中进行路由选择。</p>
</blockquote>
<ul>
<li><strong><code>TCP/IP</code></strong> 体系在网络层采用<strong>标准化协议</strong>，使<code>异构</code>的网络通过路由器可以使用<code>相同</code>的IP协议，使之互联后可被视为<code>一个虚拟IP网络</code>。</li>
<li><strong><code>虚拟互联网络</code></strong> :也称为<code>逻辑互联网络</code>，指物理网络的<strong>异构性</strong>通过<code>IP协议</code>使之在网络层看起来像一个统一的网络，这种虚拟互联网络简称为<code>IP网络</code>。</li>
<li>优点：互联网上主机通信，就如同在一个网络上通信，看不到互联网各个网络具体异构细节。</li>
</ul>
<h3 id="路由与转发"><a href="#路由与转发" class="headerlink" title="路由与转发"></a>路由与转发</h3><blockquote>
<p>路由：计算机网络中用于确定数据包从源设备到目标设备的路径选择过程。</p>
</blockquote>
<ul>
<li><p>路由选择：根据路由选择协议构造并维护路由表；</p>
<p>同时经常或定期地与相邻路由器交换信息，获取网络拓扑。</p>
<blockquote>
<p>网络拓扑：网络中各个设备（如计算机、路由器、交换器、服务器等）如何连接和组织的结构。有星型、总线型、环形等。</p>
</blockquote>
<p>动态更新维护路由表，以决定分组到达目的地结点的最优路径。</p>
</li>
<li><p>分组转发：路由器根据转发表将分组从合适的端口转发出去。</p>
<p>路由表根据路由选择算法得出；转发表通过路由表得出。</p>
<p>路由表要最优化网络拓扑变化的计算，转发表的结构需要使查找过程最优化。</p>
<blockquote>
<p>讨论路由选择的原理时，两者常合称为路由表</p>
</blockquote>
</li>
</ul>
<h3 id="拥塞控制"><a href="#拥塞控制" class="headerlink" title="拥塞控制"></a>拥塞控制</h3><ul>
<li><p>拥塞：在通信子网中，因出现过量分组而引起网络性能下降的现象称为 </p>
</li>
<li><p><code>判断拥塞</code>：观察<code>网络吞吐量</code>与<code>网络负载</code>。如果负载增加，网络吞吐量明显小于正常吞吐量，则进入<strong>轻度拥塞</strong>；网络吞吐量随负载增加而下降，则网络可能已经进入<strong>拥塞状态</strong>；如果吞吐量降为0，则网络可能已经进入<strong>死锁状态</strong></p>
</li>
<li><p><strong><code>拥塞控制</code></strong> 的作用是确保子网能承载所能达到的流量，这是一个<strong>全局性的过程</strong>，设计各方面的行为；单一地增加资源并不能解决拥塞。</p>
</li>
<li><p>拥塞控制两种方法：</p>
<ul>
<li><strong><code>开环控制</code></strong> ：在设计网络时<strong>事先将有关发生拥塞地因素考虑周到</strong>，力求网络在工作时不产生拥塞；这是一种<code>静态</code>的预防方法，一旦整个系统启动并运行，中途就不再需要修改。</li>
<li><strong><code>闭环控制</code></strong> ：事先不考虑有关发生拥塞的各种因素，采用检测网络系统去监视，及时检测哪里出现了拥塞，然后将拥塞信息传到合适的地方，以便调整网络系统的运行，并解决出现的问题。闭环控制是基于反馈环路的概念，是一种<code>动态</code>的方法。</li>
</ul>
</li>
</ul>
<p><img src="C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20250529172641787.png" alt="image-20250529172641787" style="zoom:50%;" /></p>
<p>R1-R2不可能拥塞</p>
<p>R2-R4有可能（H5-H8全部通信H1）</p>
<h3 id="网际协议IP及配套协议"><a href="#网际协议IP及配套协议" class="headerlink" title="网际协议IP及配套协议"></a>网际协议IP及配套协议</h3><p><img src="https://gitee.com/fat1ger/picbed/raw/master/img/image-20250527222658024.png" alt="image-20250527222658024" style="zoom:50%;" /></p>
<p>网际协议IP Internet Protocol</p>
<ul>
<li>数据单元是数据报</li>
<li>是 TCP/IP 体系中两个最主要 的协议之一</li>
<li>负责把数据报交付给主机，不负责数据交付的可靠性</li>
</ul>
<p>地址解析协议ARP Address Resolution Protocol</p>
<ul>
<li>由IP获得MAC地址</li>
</ul>
<p>反向地址解析协议RARP Reverse Address Resolution Protocol</p>
<ul>
<li>由MAC地址获得IP</li>
<li>来源端不知道自己的IP地址时使用</li>
</ul>
<p>网际控制报文协议ICMP Internet Control Message Protocol</p>
<ul>
<li>用以向源主机报告IP数据报在交付时出现的一些错误</li>
<li>ICMP消息包含在IP数据报之内，所以能找到回源主机的路径</li>
</ul>
<p>网际组管理协议IGMP Internet Group Management Protocol</p>
<ul>
<li>提供带有<code>多播组</code>标识的路由，使整个网络都支持多播</li>
<li>TCP/IP支持下面三种类型的数据发送：<ul>
<li>广播：把目标地址设为FFFFFFFFFFFF而发送到网上所有主机</li>
<li>多播：数据被交付到网上的一组主机，每台主机必须注册多播地址，才能接收指定多播地址的数据</li>
<li>单播：数据只被交付到一个指定地址的主机</li>
</ul>
</li>
<li>IGMP消息位于IP数据报中</li>
</ul>
<h3 id="网路层提供的两种服务"><a href="#网路层提供的两种服务" class="headerlink" title="网路层提供的两种服务"></a>网路层提供的两种服务</h3><h4 id="虚电路"><a href="#虚电路" class="headerlink" title="虚电路"></a>虚电路</h4><ul>
<li>电信网的设计思路</li>
<li>当两台计算机进行通信时，应当先建立网络层的连接，即先建立一条逻辑上的虚电路（VC）；</li>
<li>连接一旦建立，就固定了虚电路对应的物理路径。</li>
<li>整个通信过程分为三个阶段：虚电路建立、数据传输与虚电路释放。</li>
<li>面向连接（逻辑上的连接）</li>
<li>分组的首部只在连接建立时使用完整的目的地址，之后每个分组的首部只要携带这条虚电路的编号即可。</li>
<li>当某个结点或某条链路故障时，所有相关的虚电路都会被影响</li>
</ul>
<p><img src="https://gitee.com/fat1ger/picbed/raw/master/img/image-20250527221515452.png" alt="image-20250527221515452" style="zoom:50%;" /></p>
<blockquote>
<p>提供的是一种可靠的服务</p>
<p>适合实时性要求高的长时间通信，不适合故障率很高</p>
<p>多站点同时使用一条物理链路也可以，因为有虚电路编号</p>
<p>有永久性虚电路 也有临时的交换型</p>
<p>只是逻辑上连接 所以没带宽</p>
</blockquote>
<h4 id="数据报"><a href="#数据报" class="headerlink" title="数据报"></a>数据报</h4><ul>
<li>因特网采用的设计思路。</li>
<li>发送分组前不需要建立连接。</li>
<li>网络尽最大努力交付，传输不保证可靠性，分组可能出错或丢失；</li>
<li>网络为每个分组独立地选择路由，转发的路径可能不同，因此分组不一定按序到达目的结点。</li>
<li>如果需要主机间的通信是可靠的，那么由主机的<strong>传输层</strong>来负责。</li>
<li>分组正在某一连路上传送时，并不占用网络其他部分的资源。</li>
<li>好处：价格低廉，运行方式灵活。</li>
</ul>
<p><img src="https://gitee.com/fat1ger/picbed/raw/master/img/image-20250527221526061.png" alt="image-20250527221526061" style="zoom:50%;" /></p>
<div class="table-container">
<table>
<thead>
<tr>
<th>对比的方面</th>
<th>虚电路服务</th>
<th>数据报服务</th>
</tr>
</thead>
<tbody>
<tr>
<td>思路</td>
<td>可靠通信应当由网络来保证</td>
<td>可靠通信应当由用户主机来保证</td>
</tr>
<tr>
<td>连接的建立</td>
<td>必须有</td>
<td>不需要</td>
</tr>
<tr>
<td>终点地址</td>
<td>仅在连接建立阶段使用，每个分组使用短的虚电路号</td>
<td>每个分组都有终点的完整地址</td>
</tr>
<tr>
<td>分组的转发</td>
<td>属于同一条虚电路的分组均按照同一路由进行转发</td>
<td>每个分组独立选择路由进行转发</td>
</tr>
<tr>
<td>当结点出故障时</td>
<td>所有通过出故障的结点的虚电路均不能工作</td>
<td>出故障的结点可能会丢失分组，一些路由可能会发生变化</td>
</tr>
<tr>
<td>分组的顺序</td>
<td>总是按发送顺序到达终点</td>
<td>到达终点时不一定按发送顺序</td>
</tr>
<tr>
<td>端到端的差错处理和流量控制</td>
<td>可以由网络负责，也可以由用户主机负责</td>
<td>由用户主机负责</td>
</tr>
</tbody>
</table>
</div>
<h2 id="IPv4"><a href="#IPv4" class="headerlink" title="IPv4"></a>IPv4</h2><p><strong><code>IPv4</code></strong> ：IP协议版本4</p>
<p>定义了IP分组及其确切的数据格式，以及一整套规则，指明分组如何处理、错误怎样控制等。</p>
<p>IP分组：数据传送的基本单元</p>
<h3 id="IP数据报的格式"><a href="#IP数据报的格式" class="headerlink" title="IP数据报的格式"></a>IP数据报的格式</h3><p>一个IP分组（IP数据报）由<strong>首部和数据部分</strong>组成。</p>
<p>首部的前一部分的长度固定，共20B；后面是一些长度可变的可选字段。</p>
<p><img src="https://gitee.com/fat1ger/picbed/raw/master/img/image-20250528111525627.png" alt="image-20250528111525627" style="zoom:50%;" /></p>
<ul>
<li><p>版本Version：IP的版本，IPv4中该字段值为4</p>
</li>
<li><p>首部长度IHL：<strong>单位为4B</strong>，最大可表示60B首部。</p>
<blockquote>
<p>==最小5，最大15，即20~60B==</p>
<p>常用首部长度：20B，此时本字段值为5，首部不使用任何可选字段。</p>
<p>IP首部常以0x45开头。</p>
</blockquote>
</li>
<li><p>Type of service：1字节，服务类型，目前很多路由器忽略该字段</p>
</li>
<li><p>总长度Total Length：<strong>单位为1B</strong>，指首部和数据之和的长度。</p>
<ul>
<li><strong>16位</strong>，因此数据报最大长度为 $2^{16}$−1=65535B</li>
</ul>
</li>
<li><p>标识Identification：同一数据报的分片使用同一标识。</p>
</li>
<li><p>标志：DF MF ，只有两位有意义。</p>
<ul>
<li>中间位DF=1，禁止分片</li>
<li>==中间位DF=0，允许分片（分片后的数据报中DF同样为0）==</li>
<li>==最低位MF=1，后面“还有分片”==</li>
<li>最低位MF=0，说明这是最后一片或者没有分片。</li>
</ul>
</li>
<li><p>片偏移Fragment offset：==<strong>单位为8B</strong>==</p>
<ul>
<li>指出较长分组分片后，某片在原分组中的相对位置。</li>
</ul>
</li>
<li><p>生存时间Time to live TTL：每个路由器在转发数据报前对TTL–1，变成0则丢弃，并向源主机发送一个告警包</p>
</li>
<li><p>协议：数据部分的协议</p>
<ul>
<li>ICMP=1</li>
<li>IGMP=2</li>
<li>TCP=6</li>
<li>UDP=17</li>
<li>OSPF=89</li>
</ul>
</li>
<li><p>首部检验和Header checksum：只检验首部，不检验数据部分</p>
<blockquote>
<p>二进制反码求和的运算规则如下:</p>
<p>①从低 位到高位逐列进行计算,1和1相加是0并产生进位 1</p>
<p>②若最 高位相加后产生进位,则最后得到的结果要在最低位加1,该过程也称回卷</p>
</blockquote>
<ul>
<li><p>校验和算法：对IP包头，每16位求反，循环相加(进位加在末尾)，和再求反</p>
</li>
<li><p>TTL每次经过路由器转发都会被减1，所以校验和也要跟着变。所以每次都要更新校验和</p>
</li>
<li><p>错误不发送ICMP差错报文</p>
<p><img src="https://gitee.com/fat1ger/picbed/raw/master/img/image-20250528120107299.png" alt="image-20250528120107299" style="zoom:50%;" /></p>
</li>
</ul>
</li>
<li><p>源地址、目的地址：在整个传输过程中都<strong>不会变化</strong>。</p>
</li>
<li><p>选项字段：0~40B，用来支持排错、测量以及安全等措施。</p>
</li>
</ul>
<blockquote>
<p>片偏移、首部长度、总长度的单位分别为8B、4B、1B</p>
</blockquote>
<p><img src="https://gitee.com/fat1ger/picbed/raw/master/img/image-20250528165517554.png" alt="image-20250528165517554" style="zoom:50%;" /></p>
<p>4B*5=20B</p>
<p>100*8B+80-1=879B</p>
<h3 id="IP数据报分片"><a href="#IP数据报分片" class="headerlink" title="IP数据报分片"></a>IP数据报分片</h3><ul>
<li><p>最大传送单元MTU：链路层数据帧可以封装数据的上限，==以太网的MTU是1500字节==</p>
<p>所以过长的数据报需要分片。</p>
</li>
<li><p>片偏移以8B为单位</p>
<ul>
<li>==所以除了最后一个分片==，<strong>其他每个分片的数据部分长度都是8B的整数倍</strong>。</li>
</ul>
</li>
<li><p>每个分片都需要加上一个首部，注意分片的DF=0，MF需要判断是不是最后一片。</p>
</li>
<li><p>IP分组可以被路径中的路由器分片（不同网络的MTU可能不同）</p>
</li>
<li><p>但是只能由<strong>目的主机进行重组</strong></p>
</li>
</ul>
<p><img src="https://gitee.com/fat1ger/picbed/raw/master/img/image-20250528112238802.png" alt="image-20250528112238802" style="zoom:50%;" /></p>
<p>==MTU包含20B的头部==</p>
<p><img src="https://gitee.com/fat1ger/picbed/raw/master/img/image-20250528151521658.png" alt="image-20250528151521658" style="zoom:50%;" /></p>
<blockquote>
<p>与分片有关的IP数据报字段：标识、标志、片偏移</p>
<p>DF=1 分组长度超过MTU，==丢弃发送ICMP 终点不可达==</p>
</blockquote>
<h3 id="IPv4地址"><a href="#IPv4地址" class="headerlink" title="IPv4地址"></a>IPv4地址</h3><p>IP地址</p>
<ul>
<li>给互联网上每台主机（或路由器）的每个接口分配的</li>
<li>一台主机可以有2个及以上IP地址，这两个IP地址需要属于不同的网络</li>
<li>一个在全球范围内唯一的32位标识符</li>
<li>编址方式<ul>
<li>分类的IP地址（早期）</li>
<li>划分子网</li>
<li>构成超网</li>
</ul>
</li>
<li>分类的IP地址<ul>
<li>任何一类IP地址都由网络号和主机号两部分组成。</li>
<li>其中网络号标识主机（或路由器）连接到的网络，一个网络号在整个互联网范围内唯一</li>
<li>主机号标识该主机（或路由器），一个主机号在指明的网络范围内是唯一的</li>
</ul>
</li>
</ul>
<p><img src="https://gitee.com/fat1ger/picbed/raw/master/img/image-20250528091653165.png" alt="image-20250528091653165" style="zoom:50%;" /></p>
<ul>
<li><p><strong>特殊IP地址的用途</strong></p>
<p>主机号全0表示本网络本身；</p>
<p>主机号全1表示本网络的广播地址；</p>
<p>127.x.x.x保留为环回自检地址，此地址表示任意主机本身。</p>
<p>32位全为0，即0.0.0.0表示本网络上的本主机</p>
<p>32位全为1，即255.255.255.255表示整个TCP/IP网络的广播地址，又称受限广播地址。</p>
</li>
</ul>
<p><img src="https://gitee.com/fat1ger/picbed/raw/master/img/image-20250528092135435.png" alt="image-20250528092135435" style="zoom:50%;" /></p>
<ul>
<li>三类IP地址使用范围</li>
</ul>
<div class="table-container">
<table>
<thead>
<tr>
<th>类别</th>
<th>最大可用网络数目</th>
<th>第一个网络号</th>
<th>最后一个网络号</th>
<th>每个网络最大主机数</th>
</tr>
</thead>
<tbody>
<tr>
<td>A</td>
<td>2^7−2</td>
<td>1</td>
<td>126</td>
<td>2^24−2</td>
</tr>
<tr>
<td>B</td>
<td>2^14</td>
<td>128.0</td>
<td>191.255</td>
<td>2^16−2</td>
</tr>
<tr>
<td>C</td>
<td>2^21</td>
<td>192.0.0</td>
<td>223.255.255</td>
<td>2^8−2</td>
</tr>
</tbody>
</table>
</div>
<ul>
<li><p>==默认子网掩码（没有划分子网时）：==</p>
<p>A/B/C类分别为255.0.0.0 255.255.0.0 255.255.255.0</p>
<p><img src="https://gitee.com/fat1ger/picbed/raw/master/img/image-20250528173853883.png" alt="image-20250528173853883" style="zoom:50%;" /></p>
</li>
<li><p>A类少了网络号为<strong>0和127</strong>，主机数少了主机号<strong>全为0和全为1</strong></p>
</li>
<li><p>IP地址特点</p>
<ul>
<li>IP包含网络号和主机号，因此IP地址是一种分等级的地址结构。其优点有<ul>
<li>IP地址管理机构分配IP只分配网络号，主机号则由网络的单位自行分配，方便IP管理。</li>
<li>路由器仅仅根据<strong>目的主机所连接的网络号</strong>来转发分组，减少路由表所占存储空间。</li>
</ul>
</li>
<li>IP地址是标识一台主机/路由器和一条链路的接口。因此IP网络上的一个路由器必然至少拥有两个IP地址。</li>
<li>用转发器/网桥等</li>
</ul>
</li>
</ul>
<h2 id="划分子网和构造超网"><a href="#划分子网和构造超网" class="headerlink" title="划分子网和构造超网"></a>划分子网和构造超网</h2><p>将一个网络划分为多个子网，IP地址中添加子网号字段，使两级IP地址变为<strong>三级IP地址</strong>。</p>
<p>目的：</p>
<ul>
<li>减小广播域的大小</li>
<li>提高IP地址利用率</li>
</ul>
<p>（但主机数量会减小）</p>
<p>子网划分对外部网络是透明的，对内部网络是可见的。</p>
<p>划分子网的方法是从网络的<strong>主机号</strong>中借用若干位作为子网号。</p>
<blockquote>
<p>==至少需要保留2位仍为主机号==</p>
</blockquote>
<p>三级IP地址的结构：&lt;网络号&gt;,&lt;子网号&gt;,&lt;主机号&gt;。</p>
<h3 id="子网掩码"><a href="#子网掩码" class="headerlink" title="子网掩码"></a>子网掩码</h3><ul>
<li><code>子网掩码</code>：32位，一串1后面跟着一串0。1对应<strong>网络号</strong>和<strong>子网号</strong>，0对应<strong>主机号</strong>。</li>
<li>计算机只需要将IP地址和子网掩码<strong>按位与运算</strong>，即可获得子网的网络地址。</li>
<li>一台主机设置IP地址信息的同时，必须设置子网掩码。</li>
<li>同属于一个子网的所有主机和路由器的相应端口，必须设置相应的子网掩码</li>
<li>路由器的路由表中，包含信息的主要内容有目的网络地址，子网掩码，下一跳地址。</li>
</ul>
<p>==默认子网掩码（没有划分子网时）：==</p>
<p>A/B/C类分别为255.0.0.0 255.255.0.0 255.255.255.0</p>
<h3 id="分组转发"><a href="#分组转发" class="headerlink" title="分组转发"></a>分组转发</h3><h3 id="默认网关"><a href="#默认网关" class="headerlink" title="默认网关"></a>默认网关</h3><p>默认网关是连接本机或子网的路由器接口的IP地址。</p>
<p>当主机发送数据时，根据所发送的数据的目的IP地址，通过子网掩码来判定目的主机是否在子网中；</p>
<ul>
<li>如果在，则直接发送；</li>
<li>如果不在，则将数据发送到默认网关，再由网关（路由器）将其转发到其他网络</li>
</ul>
<h3 id="无分类域间路由-CIDR"><a href="#无分类域间路由-CIDR" class="headerlink" title="无分类域间路由 CIDR"></a>无分类域间路由 CIDR</h3><p>（Classless Inter-Domain Routing）无分类域间路由</p>
<p>CIDR的地址的结构：</p>
<p>IP 地址 := &lt;网络前缀&gt;,&lt;主机号&gt;</p>
<p>使用斜线记法，例：128.14.35.7/20 表示该地址的高20位是网络前缀</p>
<p><strong>路由聚合(route aggregation)/构成超网(supernetting)：</strong></p>
<ul>
<li>一个 CIDR 地址块可以表示很多地址，这种地址的聚合称为路由聚合</li>
<li>==减少路由表中表项个数，并减少路由器间交换的路由信息量==<ul>
<li>路由表中的一个项目可以表示很多个路由</li>
</ul>
</li>
<li>称为超网是由于CIDR地址块大多包含多个C类地址</li>
</ul>
<p>最长前缀匹配：</p>
<ul>
<li>使用CIDR时，路由表中每个项目由<strong>网络前缀</strong>和<strong>下一跳地址</strong>组成</li>
<li>从匹配结果中选择具有<strong>最长网络前缀</strong>的路由</li>
</ul>
<p><img src="https://gitee.com/fat1ger/picbed/raw/master/img/image-20250528153043553.png" alt="image-20250528153043553" style="zoom:50%;" /></p>
<blockquote>
<p>解释：</p>
<p>题目 …11(26) 地址范围：<code>172.16.166.192 ~ 172.16.166.255</code></p>
<p>A： …110(27) 重叠</p>
<p>B: …10(26) 不重叠  地址范围：<code>172.16.166.128 ~ 172.16.166.191</code></p>
<p>合并之后是 ….1(25)  地址范围：<code>172.16.166.128 ~ 172.16.166.255</code>，恰好等于两者之和</p>
<p>（其实可以理解成少了第26位 正好是题目的1和B的0都包含）</p>
<p>C：00(26) 不重叠  </p>
<p>合并之后是 ….(24)</p>
<p> （其实可以理解成少了第25、26位 题目是11，C是00 额外引入了01 10）</p>
<p>D同理不行</p>
</blockquote>
<h3 id="哈夫曼树"><a href="#哈夫曼树" class="headerlink" title="哈夫曼树"></a>哈夫曼树</h3><p><strong>CIDR地址块的子网划分技巧</strong>，可以利用类似于“<strong>从根到叶构造二叉哈夫曼树</strong>”的技巧</p>
<ul>
<li>原始CIDR地址块作为根节点（假设可以自由分配的主机号占 h bit）</li>
<li>每个分支节点必须同时拥有左右孩子，左0，右1</li>
<li>每个叶子节点对应一个子网，根据根节点到达叶子结点的路径；来分析子网对应的IP地址块范围</li>
<li>整棵树的高度不能超过 h-1（因为即使最小的子网也至少要保留 2 bit主机号）</li>
</ul>
<p><img src="https://gitee.com/fat1ger/picbed/raw/master/img/image-20250528150913912.png" alt="image-20250528150913912" style="zoom:50%;" /></p>
<p><img src="https://gitee.com/fat1ger/picbed/raw/master/img/image-20250528152306643.png" alt="image-20250528152306643" style="zoom:67%;" /></p>
<h2 id="地址解析协议ARP"><a href="#地址解析协议ARP" class="headerlink" title="地址解析协议ARP"></a>地址解析协议ARP</h2><p>IP地址是网络层及网络层之上使用的地址，是分层式的。</p>
<p>硬件地址（MAC）地址是数据链路层使用的，是平面式的。</p>
<blockquote>
<p>路由器不仅有多个IP地址，还有多个硬件地址</p>
</blockquote>
<h3 id="ARP功能"><a href="#ARP功能" class="headerlink" title="ARP功能"></a>ARP功能</h3><p>无论网络层使用什么协议，在实际网络的链路上传输数据帧时，最终必须使用硬件地址。</p>
<p>ARP完成<strong>IP地址到MAC地址的映射</strong>。</p>
<p>每台主机都设有一个<strong>ARP高速缓存</strong>，用来存放本局域网上各主机和路由器的IP地址到MAC地址的映射表，称为<strong>ARP表</strong>。</p>
<h3 id="工作原理"><a href="#工作原理" class="headerlink" title="工作原理"></a>工作原理</h3><blockquote>
<p>ARP 请求报文的目的IP地址是目的主机的IP地址,目的MAC 地址是广播 MAC 地址</p>
<p>ARP 响应报文的目的IP地址是发起ARP 请求的主机的IP地址，目的MAC地址是发起ARP 请求的主机的MAC地址</p>
</blockquote>
<p>A想向B发送IP数据报：（同一局域网）</p>
<ol>
<li><p>在ARP高速缓存中查看有无B的IP地址</p>
</li>
<li><p>若有，则可以查出对应的硬件地址，并<strong>写入MAC帧</strong>。</p>
</li>
<li><p>若没有，通过使用==【目的MAC地址为FF-FF-FF-FF-FF-FF】==的帧来封装并广播ARP请求分组（广播发送），</p>
<p><strong>同一个局域网</strong>内所有的主机都收到此ARP请求</p>
</li>
<li><p>主机B收到ARP请求后，向A发出ARP响应分组（单播发送），分组中包含B的IP和MAC地址的映射关系</p>
</li>
<li><p>A收到后，将此映射写入ARP缓存，然后回到步骤2。</p>
</li>
</ol>
<blockquote>
<p>广播的ARP请求分组中，并不包含待发送的数据报。</p>
</blockquote>
<p>ARP用于解决<strong>同一局域网上的</strong>主机或路由器的IP和MAC的映射问题</p>
<p>如果目的主机和源主机不在同一个局域网上，则需要通过ARP找到本局域网上的某个路由器的硬件地址，再把分组发送给这个路由器，让路由器把分组转发给下一个网络</p>
<ul>
<li><p>ARP广播只在子网中传播，如果相互通信的主机不在同一个子网内，就不能直接通过ARP广播获得目的站的硬件地址。</p>
</li>
<li><p>硬件地址只具有本地意义，所以每当路由器将IP数据报发送到一个具体的网络中时，都需要<strong>重新封装源硬件地址和目的硬件地址</strong>。</p>
<blockquote>
<p>MAC地址是点到点传输用的，端到端传输中包含很多点到点，所以每次都需要更新MAC地址。</p>
</blockquote>
</li>
</ul>
<p><img src="https://gitee.com/fat1ger/picbed/raw/master/img/image-20250528155734471.png" alt="image-20250528155734471" style="zoom:50%;" /></p>
<h2 id="网际控制报文协议ICMP"><a href="#网际控制报文协议ICMP" class="headerlink" title="网际控制报文协议ICMP"></a>网际控制报文协议ICMP</h2><p>Internet Control Message Protocol</p>
<p>作用：有效地转发IP数据报和提高交付成功的机会，在网络层使用了ICMP，让主机或路由器报告差错和异常情况。</p>
<p>ICMP报文被封装在<strong>IP数据报</strong>中发送，但ICMP不是高层协议，而是<strong>网络层的协议</strong></p>
<p><img src="https://gitee.com/fat1ger/picbed/raw/master/img/image-20250528160636930.png" alt="image-20250528160636930" style="zoom:50%;" /></p>
<h3 id="ICMP报文类型"><a href="#ICMP报文类型" class="headerlink" title="ICMP报文类型"></a>ICMP报文类型</h3><p>9种，包括ICMP差错报告报文和ICMP询问报文</p>
<ul>
<li><p>==差错报告报文==</p>
<ul>
<li>Destination unreachable：终点不可达，路由器或主机无法传输报文时向源主机发送此报文</li>
<li>Time exceeded：超时，路由器收到TTL字段为0的报文时，向源主机发送此报文</li>
<li>Parameter problem：参数问题，路由器或主机收到的报文中头部有非法字段时，丢弃数据包，并向源主机发送此报文</li>
<li>Source quench：源点抑制，路由器或主机由于拥塞丢弃报文时，向源主机发送此报文，使其放慢发送速度</li>
<li>Redirect：重定向，路由器向主机发送此报文告知路由改变，主机下次发送数据报给另外的路由器</li>
</ul>
</li>
<li><p>询问报文</p>
<ul>
<li>Echo request / reply：回声探测，用于测试网络连通性</li>
<li>Timestamp request / reply：请求时间，可用于时间同步</li>
</ul>
</li>
</ul>
<p><strong>不应发送ICMP差错报文的情况</strong></p>
<ul>
<li><p>对ICMP报文不发送ICMP报文</p>
<blockquote>
<p>报错的不报错</p>
</blockquote>
</li>
<li><p>对第一个分片的数据报文的<strong>后续</strong>数据报文不发送ICMP</p>
<blockquote>
<p>分片只报第一个</p>
</blockquote>
</li>
<li><p>对具有多播地址的数据报不发送</p>
</li>
<li><p>对具有特殊地址（如127.0.0.0或0.0.0.0）的数据报不发送</p>
</li>
</ul>
<h3 id="应用"><a href="#应用" class="headerlink" title="应用"></a>应用</h3><p>PING：</p>
<p>用来测试两个主机之间的连通性</p>
<p>使用ICMP回送请求和回答报文</p>
<blockquote>
<p>ping在应用层</p>
<p>直接使用ICMP，跳过了传输层的UDP和TCP</p>
</blockquote>
<p>Traceroute：</p>
<p>用来测试到另一台主机所经过的路由信息</p>
<p>使用ICMP时间超过报文</p>
<p>逐个发出UDP报文，其IP包头中的TTL字段分别设为1, 2, 3, …，直到到达目的主机</p>
<p>报文路由路径上的路由器会返回ICMP超时报文，从该报文即可得知路由器IP地址</p>
<blockquote>
<p>Traceroute工作在网络层</p>
</blockquote>
<h2 id="路由算法与路由协议"><a href="#路由算法与路由协议" class="headerlink" title="路由算法与路由协议"></a>路由算法与路由协议</h2><p>路由器依据路由信息(路由表)转发分组</p>
<p>路由信息是路由协议生成的，路由算法是路由协议的基础和核心</p>
<p>路由算法的目的：</p>
<p>找到一条从源路由器到目的路由器的最佳路径。</p>
<ul>
<li><p>静态路由算法：</p>
<ul>
<li>网络管理员手动配置每一条路由</li>
<li>非自适应路由选择</li>
<li>简单和开销较小</li>
<li>不及时</li>
</ul>
</li>
<li><p>动态路由算法：</p>
<ul>
<li>根据网络流量负载和拓扑结构的变化来动态调整自身的路由表</li>
<li>自适应路由选择</li>
<li>复杂和开销较大</li>
<li>包括： 距离向量路由算法 、链路状态路由算法</li>
</ul>
</li>
</ul>
<p>==自治系统(AS—Autonomous System)的概念==</p>
<ul>
<li>在单一的技术管理下的一组路由器，而这些路由器使用一种 AS 内部的路由选择协议和共同的度量以确定分组在该 AS 内的路由</li>
<li>同时还使 用一种AS 之间的路由选择协议用以确定分组在AS之间的路由</li>
<li>1个 AS可使用多种内部路由选择协议和度量，但对其他 AS 表现出的是单一的和一致的路由选择策略</li>
</ul>
<p>Internet路由协议</p>
<ul>
<li>内部网关协议 IGP Interior Gateway Protocol</li>
<li>外部网关协议 EGP External Gateway Protocol</li>
</ul>
<ul>
<li>自治系统之间的路由选择又称为域间路由选择(interdomain routing) </li>
<li>自治系统内部的路由选择又称为域内路由选择(intradomain routing)</li>
</ul>
<blockquote>
<p><strong>路由收敛</strong>：</p>
<p>当路由环境发生变化后,各路由器调整自己的<strong>路由表</strong>以适应<strong>网络拓扑结构</strong>的变化,最终达到稳定状态(路由表与网络拓扑状态保持一致)</p>
<p>收敛越快,路由器就能越快适应网络拓扑结构的变化</p>
</blockquote>
<h3 id="RIP协议和距离向量路由"><a href="#RIP协议和距离向量路由" class="headerlink" title="RIP协议和距离向量路由"></a>RIP协议和距离向量路由</h3><p>RIP协议 Routing Information Protocol</p>
<p>距离向量路由 distance vector routing</p>
<h4 id="距离向量路由算法"><a href="#距离向量路由算法" class="headerlink" title="距离向量路由算法"></a>距离向量路由算法</h4><p>基础是图的Bellman-Ford算法，对每个节点计算单源最短路径。</p>
<p>初始化时每个结点向其邻居发送距离向量，在接受到该更新报文后，每个节点重新计算自己的距离向量。距离向量发生更新的结点再次向邻居发送更新的距离向量。</p>
<p>显然，更新报文的大小与网络中的结点数量成正比。</p>
<p>最常见的距离–向量路由算法是<strong>RIP算法</strong>，采用“跳数”作为距离的衡量。</p>
<h4 id="路由信息协议RIP"><a href="#路由信息协议RIP" class="headerlink" title="路由信息协议RIP"></a>路由信息协议RIP</h4><p>一种分布式的基于距离向量的路由选择协议。</p>
<p>==RIP是<strong>应用层</strong>协议，使用UDP传送数据==</p>
<p><strong>规定：</strong></p>
<ul>
<li><p>每个路由器都需要维护从它自身到其他各个目的网络的距离记录（距离向量）</p>
</li>
<li><p>RIP使用<strong>跳数</strong>来衡量到达目的网络的距离。</p>
<p>从路由器到直接连接的网络的距离定义为1；而每经过一个路由器，距离+1</p>
</li>
<li><p>跳数越少，RIP认为路由更好。</p>
</li>
<li><p>RIP一条路径中最多包含15个路由器，所以距离=16时表示网络不可达。</p>
<p>避免循环。</p>
</li>
<li><p>每个路由表项都有三个关键字段：<code>&lt;目的网络N，距离d，下一跳路由器地址X&gt;</code></p>
</li>
</ul>
<p><strong>特点：</strong></p>
<ul>
<li>仅和直接相邻的路由器交换信息</li>
<li>交换的信息是本路由器所知道的<strong>全部信息</strong>，即自己的路由表。</li>
<li>按照固定的时间间隔（30s）交换路由信息。</li>
<li>刚开始工作时，只知道自己到直接相连的几个网络的距离为1。</li>
<li>选择的路径不一定是时间最短的，但是一定具有最少的路由跳数。</li>
</ul>
<p><strong>RIP报文格式：</strong></p>
<p><img src="https://gitee.com/fat1ger/picbed/raw/master/img/image-20250529000059318.png" alt="image-20250529000059318" style="zoom:50%;" /></p>
<p><strong>算法：</strong></p>
<p>RIP报文：包含路由表中的所有信息。</p>
<p>收到相邻路由器(其地址为 X)的一个 RIP 报文：</p>
<p> (1) 先修改此 RIP 报文中的所有项目：把“下一跳”字段中的地址都改为 X，并把所有的 “距离”字段的值加 1。每个项目有三个关键数据：目的网络N、距离d、下一跳路由器X。 </p>
<p>(2) 对修改后的 RIP 报文中的每一个项目，重复以下步骤：</p>
<p>若路由表中没有目的网络N，则把该项目加到路由表中。 </p>
<p>否则 </p>
<p>若下一跳字段给出的路由器地址是X，则用收到的项目替换原有项目</p>
<p>否则</p>
<p>若收到项目中的距离d小于路由表中的距离，则进行更新</p>
<p>否则，什么也不做。 </p>
<p>(3) 若 3 分钟还没有收到相邻路由器的更新路由表，则把此相邻路由器记为不可达路由器， 即将距离置为16（距离为16表示不可达）</p>
<p>(4) 返回</p>
<p><strong>优点：</strong></p>
<ul>
<li>实现简单、开销小、收敛过程较快</li>
<li>发现更短路由的更新消息传播很快</li>
</ul>
<p><strong>缺点：</strong></p>
<ul>
<li>RIP限制了网络的规模，能使用的最大距离为15</li>
<li>路由器之间交换完整的路由表，网络规模越大，开销也就越大</li>
<li>网络出现故障时，路由器之间需要反复多次传递消息才能完成收敛。</li>
</ul>
<blockquote>
<p>==好消息传播得快，坏消息传播得慢==</p>
<p><img src="https://gitee.com/fat1ger/picbed/raw/master/img/image-20250529001137934.png" alt="image-20250529001137934"></p>
<p>1.R3检测到一个不可达网络，说明该网络是和R3相连的（在RIP协议中，检测到网络不可达是由相邻结点检测到的），假设记为R4，也就是说这整个网络由R1、R2、R3、R4组成；</p>
<p>2.题中说到开始的时候“均已收敛”，即在R3检测到R4不可达之前，网络中各个网络已经互相知道了到彼此的距离，通过网络结构可知R1的距离向量为（0，1，1，2），R2的距离向量为（1，0，1，2），R3的距离向量为（1，1，0，1）</p>
<p>3.现在R3检测到R4不可达，即R3的距离向量变为（1，1，0，16），并且现在只向R2通报了自己新的距离向量</p>
<p>4.R2收到R3传过来的距离向量时，对于R2→R4的路径长度，它会比较R2→R3→R4（距离17）和R2→R1→R3→R4（距离为3，此处R1→R3→R4的距离是2，因为R1还不知道R3到R4的代价变为16了（坏消息传得慢))，R2比较17和3选择较小的3，因此选B</p>
</blockquote>
<p>how to 交换信息：</p>
<p><img src="https://gitee.com/fat1ger/picbed/raw/master/img/image-20250529171338494.png" alt="image-20250529171338494" style="zoom:50%;" /></p>
<p><img src="https://gitee.com/fat1ger/picbed/raw/master/img/image-20250529171344968.png" alt="image-20250529171344968" style="zoom:50%;" /></p>
<h3 id="OSPF协议和链路状态路由"><a href="#OSPF协议和链路状态路由" class="headerlink" title="OSPF协议和链路状态路由"></a>OSPF协议和链路状态路由</h3><p>链路状态路由：link-state routing</p>
<p>OSPF协议：Open Shortest Path First</p>
<h4 id="链路状态路由算法"><a href="#链路状态路由算法" class="headerlink" title="链路状态路由算法"></a>链路状态路由算法</h4><p>每个路由器完成5步工作: </p>
<p>① 发现它的邻居结点，并学习其网络地址 </p>
<p>② 测量到各邻居结点的延迟或开销</p>
<p>③ 构造一个分组，其中包含所有它刚刚知道的信息</p>
<p>④ 将这个分组发送给其他所有路由器</p>
<p>⑤ 计算出到每一个其他路由器的最短路径</p>
<p><strong>链路状态</strong>指本路由器和哪些路由器相邻，以及相应链路的“度量” (metric)</p>
<p>==<strong>链路状态数据库实际上是全网的拓扑结构图</strong>==，它在全网范围内是一致的(即链路状态数据库的同步)</p>
<p>于是每个节点都可以用Dijkstra算法计算出到其他节点的最短路径。</p>
<p>典型：<strong>OSPF算法</strong></p>
<h4 id="开放最短路径优先OSPF"><a href="#开放最短路径优先OSPF" class="headerlink" title="开放最短路径优先OSPF"></a>开放最短路径优先OSPF</h4><p>使用分布式链路状态路由算法的典型代表</p>
<p>==OSPF是<strong>网络层协议</strong>==，不使用UDP或TCP，而是<strong>直接使用IP数据报</strong>传送。</p>
<p><strong>与RIP的区别：</strong></p>
<ul>
<li><p>OSPF使用<strong>洪泛法</strong>向本自治系统内所有路由器发送信息</p>
<blockquote>
<p>洪泛(flooding): 结点收到分组时，向除输入链路外的所有其他链路发送出去</p>
</blockquote>
<p>RIP则只向与自己相邻的几个路由器发送信息</p>
</li>
<li><p>OSPF发送的信息是与本路由器相邻的所有路由器的链路状态（是路由器知道的信息的一部分）</p>
<p>RIP发送的是本路由器的整个路由表</p>
</li>
<li><p>OSPF中，当链路状态<strong>发生变化时</strong>，路由器才用洪泛法发送信息，<strong>且更新过程收敛很快</strong></p>
<blockquote>
<p>不会出现“坏消息传递得慢”的情况。</p>
</blockquote>
<p>RIP中，不管网络拓扑是否发生变化，路由器之间都要定期交换路由表信息。</p>
</li>
<li><p>一个路由器的链路状态只涉及与相邻路由器的连通状态，与整个网络的规模并没有直接关系</p>
</li>
</ul>
<p><strong>特点：</strong></p>
<ol>
<li>OPSF允许对每条路由<code>设置不同的代价</code>，对不同类型的业务可以计算出不同的路由</li>
<li>如果到同一个目的网络有多条相同代价的路径，则可以将通信量分配给这几条路径</li>
<li>OSPF分组具有<code>鉴别功能</code>，从而保证仅在<code>可信赖的路由器之间</code>交换链路状态信息。</li>
<li>OSPF支持可变长度的子网划分和无分类编址CIDR</li>
<li>每个链路状态都带上一个32位的序号，序号越大表示状态越新。</li>
<li>所有的路由器都能建立一个链路状态数据库，即<strong>全网拓扑图</strong></li>
</ol>
<p><strong>优点：</strong></p>
<ul>
<li>收敛速度快：链路状态变化会泛洪给网络</li>
<li>适用于较大规模的网络：仅在链路状态发生变化时发送洪泛信息</li>
</ul>
<p><strong>区域划分：</strong></p>
<ul>
<li>OSPF将一个自治系统再划分为若干更小的范围，称为<code>区域</code></li>
<li>区域划分好处：将利用洪泛法交换链路信息的范围局限在每个区域，减少了整个网络上的通信量</li>
<li>在一个区域内部的路由器只知道本区域的完整网络拓扑，不知道其他区域的情况</li>
<li>划分区域使交换信息的种类增多，==同时也让OSPF协议更加复杂==</li>
<li>在上层的区域叫做<strong>主干区域</strong>，用来连通其他在下层的区域。</li>
<li>主干路由器可以兼做区域边界路由器</li>
</ul>
<p><strong>OSPF报文：</strong></p>
<p><img src="C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20250529145050597.png" alt="image-20250529145050597" style="zoom:50%;" /></p>
<p><strong>OSPF报文类型：</strong></p>
<p>Hello、Database Description、Link State Request、Link State Update、Link State Acknowledgment</p>
<p><img src="C:\Users\ASUS\AppData\Roaming\Typora\typora-user-images\image-20250529145606725.png" alt="image-20250529145606725" style="zoom:50%;" /></p>
<h3 id="BGP和路径向量路由"><a href="#BGP和路径向量路由" class="headerlink" title="BGP和路径向量路由"></a>BGP和路径向量路由</h3><p>Border Gateway Protocol</p>
<p>一种外部网关路由协议，源主机和目标主机属于不同的自治系统</p>
<ul>
<li><p>路径向量：要到达某个网络所要经过的一系列 AS，BGP所交换的网络可达性的信息</p>
</li>
<li><p>BGP发言人：配置BGP时，每个AS的管理员要选择至少一个路由器，作为该AS的发言人。一般是BGP边界路由器。</p>
</li>
<li>交换网络可达性的信息。</li>
<li>发生变化时更新有变化的部分。</li>
</ul>
<p>==BGP是应用层协议，借助<strong>TCP传送</strong>==</p>
<p>特点：</p>
<ul>
<li>交换信息的结点数量级是AS个数的数量级，比AS中的网络数少很多</li>
<li>每个自治系统中BGP发言人(或边界路由器)的数目很少<ul>
<li>自治系统间的路由选择不致过分复杂</li>
</ul>
</li>
<li>BGP支持CIDR</li>
<li>BGP路由表包括目的网络前缀、下一跳路由器，以及到达该目的网络要经过的各个自治系统序列</li>
<li>BGP刚运行时，BGP的临站交换整个BGP路由表，但以后只在发生变化时更新有变化的部分。</li>
</ul>
<p>四种报文：</p>
<ul>
<li>OPEN报文：用来与相邻的另一个BGP发言人建立关系</li>
<li>UPDATE报文：用来发送某一路由的信息，以及列出要撤消的多条路由</li>
<li>KEEPALIVE报文：用来确认打开报文和周期性地证实邻站关系</li>
<li>NOTIFICATION报文：用来发送检测到的差错</li>
</ul>
<p><img src="https://gitee.com/fat1ger/picbed/raw/master/img/image-20250529151626482.png" alt="image-20250529151626482" style="zoom:50%;" /></p>
<blockquote>
<p>距离向量路由协议通过周期性地向邻居发送整个路由表来更新路由信息，使用Bellman-Ford算法，收敛较慢且易产生环路；链路状态路由协议通过洪泛链路状态信息构建全网拓扑，使用Dijkstra算法，收敛快且触发更新，适用于大型网络。</p>
<p>\1. <strong>工作方式</strong>：距离向量协议（如RIP）每个节点仅与邻居交换路由表，仅知晓到达目标的距离和方向；链路状态协议（如OSPF）每个节点收集全网链路状态，独立计算路径。
\2. <strong>更新机制</strong>：距离向量定期发送完整路由表，存在冗余；链路状态仅在拓扑变化时发送增量更新，效率更高。
\3. <strong>收敛速度</strong>：距离向量因逐跳传递导致收敛慢；链路状态通过全局信息快速收敛。
\4. <strong>算法与环路</strong>：距离向量依赖Bellman-Ford，需抑制定时器防环路；链路状态基于Dijkstra避免环路。
\5. <strong>资源占用</strong>：距离向量内存需求低但带宽消耗大；链路状态内存和计算要求高但带宽占用少。
\6. <strong>适用场景</strong>：距离向量适合小型网络；链路状态扩展性强，适用于复杂大型网络。</p>
</blockquote>
<p>RIP 处于 UDP 的上层，RIP 所接收的路由信息都封装在 UDP 的数据报中</p>
<p>OSPF 的位置位于网络层，因为<strong>要交换的信息量较大</strong>，所以应使报文的长度尽量短，因此采用IP</p>
<p>BGP要在不同的自治系统之间交换路由信息，因为<strong>网络环境复杂</strong>，需要保证可靠的传输，所以选择 TCP</p>
<p>内部网关协议主要设法使数据报在一个自治系统中尽可能有效地从源站传送到目的站，在一个自治系统内部并不需要考虑其他方面的策略</p>
<p>然而 BGP 使用的环境却不同</p>
<ul>
<li>互联网规模太大，使得自治系统之间的路由选择非常困难</li>
<li>对于自治系统之间的路由选择，要寻找最佳路由是不现实的</li>
<li>自治系统之间的路由选择必须考虑有关策略</li>
<li>BGP只能力求寻找一条能够到达目的网络目较好的路由，而<strong>并非寻找一条最佳路由</strong></li>
<li>BGP 不需要像 RIP 那样周期性地和邻站交换路由信息</li>
</ul>
<h2 id="网络层设备"><a href="#网络层设备" class="headerlink" title="网络层设备"></a>网络层设备</h2><h3 id="冲突域和广播域"><a href="#冲突域和广播域" class="headerlink" title="冲突域和广播域"></a>冲突域和广播域</h3><ul>
<li><p>冲突域：指连接到同一物理介质上的所有节点的集合，这些节点之间存在介质争用的现象</p>
<blockquote>
<p>‌<strong>介质争用</strong>‌是指在使用共享介质的网络(以太网)中，多个设备同时尝试使用通信信道时发生的情况。当两个或更多个设备同时发送数据时，它们会竞争使用同一个信道，这会导致信道被多个设备同时占用，从而影响数据的正常传输。</p>
</blockquote>
<p>集线器、中继器等不能划分冲突域；</p>
<p>网桥、交换机、路由器设备可以划分冲突域</p>
</li>
<li><p>广播域：指接收同样广播消息的结点集合</p>
<p>集线器、中继器、网桥、交换机不能划分广播域</p>
<p>路由器可以划分广播域，也可以连接不同的广播域。</p>
<blockquote>
<p>通常说的局域网（LAN）特指使用路由器分割的网络，也就是广播域</p>
</blockquote>
</li>
</ul>
<h3 id="路由器"><a href="#路由器" class="headerlink" title="路由器"></a>路由器</h3><p><img src="https://gitee.com/fat1ger/picbed/raw/master/img/image-20250529152844096.png" alt="image-20250529152844096" style="zoom:50%;" /></p>
<ul>
<li>路由器是一种具有多个输入/输出端口的专用计算机，其任务是连接不同的网络（异构网络），并完成分组转发。</li>
<li>在多个逻辑网络互连时必须使用路由器。</li>
</ul>
<p><strong>工作过程</strong></p>
<p>当源主机向目标主机发送数据报时，路由器先检查源主机与目标主机是否连接在同一个网络上。</p>
<ul>
<li>若是，则直接交付而无需通过路由器</li>
<li>若否，则路由器按照<strong>转发表</strong>（由路由表得出）指出的路由，将分组转发给下一个路由器。这叫<code>间接交付</code>。</li>
<li>从结构上看，路由器由<strong>路由选择</strong>和<strong>分组转发</strong>两部分构成</li>
<li>从模型上看，路由器是网络层设备，实现了网络模型的下三层，即物理层、数据链路层、网络层。</li>
</ul>
<ul>
<li><p>分组转发：路由器根据转发表把收到的IP数据报从何时的端口转发出去，只涉及一个路由器</p>
<p>转发靠查找转发表，而不是路由表</p>
</li>
<li><p>路由选择：涉及很多路由器，路由表是许多路由器协同工作的结果。</p>
</li>
</ul>
<ul>
<li>路由选择部分也称控制部分，核心构建是<strong>路由选择处理机</strong>，任务是根据选定的路由协议<code>构造并维护路由表</code></li>
<li>分组转发由三部分组成：<code>交换结构</code>、<code>一组输入端口</code>、<code>一组输出端口</code>。<ul>
<li>交换结构：根据转发表对分组进行处理，将某个输入端口进入的分组从一个合适的端口转发出去。</li>
<li>输入端口：从数据链路层中提取出帧，剥去帧的首部和尾部后，分组被送入网络层的处理模块。</li>
<li>输出端口：执行和输入端口相反的操作</li>
<li>端口都设有一个<code>缓冲队列</code>，用来暂存分组，还可以用来进行<strong>差错检测</strong></li>
<li>当排队的分组数量过多时，可 能导致路由器内部缓冲区溢出丢包</li>
</ul>
</li>
</ul>
<p><img src="https://gitee.com/fat1ger/picbed/raw/master/img/image-20250529153851127.png" alt="image-20250529153851127" style="zoom:50%;" /></p>
<p><strong>路由表和转发表</strong></p>
<ul>
<li><code>路由表</code>是根据路由选择算法得出的。</li>
<li>标准的路由表具有4个项目：<code>目的网络IP地址</code>、<code>子网掩码</code>、<code>下一跳IP地址</code>、<code>接口</code></li>
<li>路由表包含到互联网的默认路由，默认路由的目的地址和子网掩码都是0.0.0.0</li>
<li><code>转发表</code>是由路由表得出的，其结构应该使查找过程最优化。</li>
<li>转发表中含有一个分组将要发往的目的地址，以及分组的下一跳。</li>
<li>可以用一个默认路由代替所有具有相同下一跳的项目，并把默认路由设置得比其他项目优先级低。</li>
</ul>
<p>路由器设计的关键之一是<strong>分组的高速转发</strong></p>
<p>决定报文转发速率的因素有：</p>
<ul>
<li>输入/输出端口的处理性能</li>
<li>交换机构的性能</li>
</ul>
<p>线速:输入端口的处理速率不低于线路传输分组的速度,确保数据无延迟处理</p>
<p>衡量路由器性能的指标：pps(packet per second)</p>
<p><img src="https://gitee.com/fat1ger/picbed/raw/master/img/image-20250529154845111.png" alt="image-20250529154845111" style="zoom:50%;" /></p>
<h3 id="SDN基本概念"><a href="#SDN基本概念" class="headerlink" title="SDN基本概念"></a>SDN基本概念</h3><ul>
<li>网络层可以抽象地划分为:<ul>
<li>控制平面(control plane) <ul>
<li>生成路由表和转发表 </li>
<li>路由选择</li>
</ul>
</li>
<li>数据平面(data plane) <ul>
<li>进行分组的快速转发</li>
<li>分组转发</li>
</ul>
</li>
</ul>
</li>
<li><strong>软件定义网路(SDN)</strong> ：<ul>
<li>控制平面和数据平面分离</li>
<li>采用<strong>集中式的控制层面</strong>和<strong>分布式的数据层面</strong></li>
<li>控制层面：逻辑上的<strong>远程控制器</strong><ul>
<li>掌握各个主机和整个网络的状态，为每个分组计算出最佳路由，通过<code>Openflow</code>协议将转发表下发给<code>路由器</code></li>
</ul>
</li>
<li>数据层面： 路由器(SDN称为交换机)<ul>
<li>路由器只需要<code>收到分组</code>，<code>查找转发表</code>，<code>转发分组</code></li>
</ul>
</li>
</ul>
</li>
<li>SDN优点：<ul>
<li>适用于路由策略变化频繁的网络<ul>
<li>云数据中心网络</li>
</ul>
</li>
<li>全局集中式控制和分布式高速转发</li>
<li>灵活可编程与性能的平衡<ul>
<li>网络可以由专有的自动化工具<strong>以编程方式配置</strong></li>
</ul>
</li>
<li>降低成本<ul>
<li>使用开放的接口协议后，就实现了<strong>网络设备的制造与功能软件的开发相分离</strong></li>
</ul>
</li>
</ul>
</li>
<li>SDN问题：<ul>
<li>安全风险<ul>
<li>集中管理<strong>容易受攻击</strong>，如果崩溃整个网络会受到影响</li>
</ul>
</li>
<li>瓶颈问题<ul>
<li>控制层面集中化后，网络规模扩大，控制器影响网络性能</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="IP组播"><a href="#IP组播" class="headerlink" title="IP组播"></a>IP组播</h2><ul>
<li>实现一点对多点的数据传输</li>
<li>典型应用：网络视频服务(e.g. 视频会议、直播)</li>
</ul>
<ul>
<li><p>源地址：源主机IP地址</p>
</li>
<li><p>目的地址：IP多播地址，即D类地址</p>
<p>223.0.0.0~239.255.255.255</p>
<p>每个D类IP地址标示一个多播组</p>
</li>
<li><p>使用IGMP协议</p>
</li>
<li><p>尽最大努力交付，不提供可靠交付</p>
</li>
<li><p>多播地址只能用于目的地址，不能用于源地址</p>
</li>
<li><p>对多播数据报不产生ICMP差错报文</p>
</li>
</ul>
<p>组播可分为两种：</p>
<ul>
<li>在局域网中的硬件组播<ul>
<li>将MAC地址中的特定地址段（01-00-5E-00-00-00 到 01-00-5E-7F-FF-FF）作为组播地址</li>
<li>要把 IP 多播地址映射成多播 MAC 地址</li>
<li>D类IP地址可供分配的有28位,即这28位中的前5位无法映 射到以太网多播地址</li>
<li>32个多播地址映射成一个MAC地址</li>
</ul>
</li>
<li>在Internet中的组播<ul>
<li>路由器需支持组播，即组播路由器 </li>
<li>主机通过IGMP协议与组播路由器通信，加入/退出某个组播组</li>
<li>组播路由器之间通过组播路由协议实现组播数据报的传输</li>
</ul>
</li>
</ul>
<p><strong>网际组管理协议IGMP</strong></p>
<p>路由器要获取多播组的成员信息，需要利用IGMP。</p>
<p>被封装在IP数据报中传输。</p>
<p>IGMP 是让连接到<strong>本地局域网上</strong>的多播路由器，知道本局域网上是否有主机参加或退出了某个多播组</p>
<p>IGMP 并不是在互联网范围内对所有多播组成员进行管理的协议</p>
<p>IGMP 不知道IP多播组包含的成员数,也不知道这些成员分布在哪些网络上。</p>
<p>工作分为两个阶段：</p>
<ol>
<li><p>当某台主机加入新的多播组时，该主机应向多播组的多播地址发送一个IGMP报文，声明自己要成为该组的成员</p>
</li>
<li><p>组成员关系是动态的。</p>
<p>本地多播路由器周期性地探寻本地局域网上的主机，以便知道这些主机是否仍继续是组的成员。</p>
<p>只要对某个组有一台主机相应，多播路由器就认为这个组是活跃的。</p>
</li>
</ol>
<p>多播路由选择实际上就是要找出以源主机为根节点的多播转发树</p>
<p>不同的多播组对应于不同的多播转发树</p>
<p>同一个多播组,对不同的源点也会有不同的多播转发树</p>
<h2 id="网络地址转换NAT"><a href="#网络地址转换NAT" class="headerlink" title="网络地址转换NAT"></a>网络地址转换NAT</h2><p>Network Address Translation</p>
<p>指的是通过<strong>专用网络地址转换为公用地址</strong>，从而对外隐藏内部管理的IP地址。</p>
<p>它使得整个专用网只需要一个全球IP地址就可以与互联网连通</p>
<p><strong>私有IP地址</strong>：</p>
<ul>
<li>私有IP地址只用于LAN，不用于WAN连接</li>
<li>私有IP地址称为<strong>可重用地址</strong><ul>
<li>允许私有IP地址被LAN重复使用</li>
</ul>
</li>
<li>采用私有IP地址的互联网称为<strong>专用互联网/本地互联网</strong></li>
<li>NAT路由器使用NAT表将本地IP地址和全球IP地址进行转换，由此可以将多个私有IP地址<strong>映射</strong>到一个全球IP地址。</li>
</ul>
<p>互联网的路由器对目的地址是私有地址的IP数据报一律不进行转发</p>
<ul>
<li><strong>10.0.0.0/8</strong>，即 10.0.0.0~10.255.255.255，相当于1个A类网络。</li>
<li><strong>172.16.0.0/12</strong>，即 172.16.0.0~172.31.255.255，相当于 16 个连续的 B类网络。</li>
<li><strong>192.168.0.0/16</strong>，即 192.168.0.0~192.168.255.255，相当于 256 个连续的C类网络。</li>
</ul>
<ul>
<li>普通路由器在转发IP分组的时候，其源IP地址和目的IP地址都不会改变；</li>
<li><strong>NAT路由器</strong>在转发IP分组时，一定要更换其IP地址；</li>
<li>普通路由器仅工作在<strong>网络层</strong>，不改变IP数据报的IP地址字段。</li>
<li>NAT路由器转发数据报时需要查看和转换<strong>传输层</strong>的端口号</li>
<li>NAT路由器内部使用TCP/UDP端口号实现外网数据包向内网地址的转换</li>
</ul>
<p><img src="https://gitee.com/fat1ger/picbed/raw/master/img/image-20250528200328473.png" alt="image-20250528200328473" style="zoom:50%;" /></p>
<blockquote>
<p>例题：</p>
<p><img src="https://gitee.com/fat1ger/picbed/raw/master/img/image-20250528191729234.png" alt="image-20250528191729234" style="zoom: 33%;" /></p>
<p><img src="https://gitee.com/fat1ger/picbed/raw/master/img/image-20250528191852409.png" alt="image-20250528191852409" style="zoom: 33%;" /></p>
</blockquote>
<h2 id="虚拟专用网VPN"><a href="#虚拟专用网VPN" class="headerlink" title="虚拟专用网VPN"></a>虚拟专用网VPN</h2><p>Virtual Private Network </p>
<p>多个企业/机构的内网之间互连的实现方法</p>
<ul>
<li>租用专用线路，形成专用网，成本高昂</li>
<li>基于公用网络(如Internet)，形成VPN</li>
</ul>
<p>VPN涉及的技术</p>
<ul>
<li>隧道(tunnel)</li>
<li>加密</li>
<li>身份认证</li>
</ul>
<p>基于Internet建立VPN的两种情形：</p>
<ul>
<li><p>内部网络通过Internet互连</p>
<ul>
<li>可以采用IPSec的ESP隧道模式</li>
<li>（工作在网络层、无安全机制）</li>
</ul>
</li>
<li><p>远程用户访问内部网(remote access VPN)</p>
<ul>
<li>拨号虚拟专用网(VPDN—-Virtual Private Dialup Network)</li>
<li>基于SSL的VPN技术</li>
<li>客户端无须安装或配置软件</li>
</ul>
</li>
</ul>
<p>隧道：</p>
<p><img src="https://gitee.com/fat1ger/picbed/raw/master/img/image-20250401082536179.png" alt="image-20250401082536179" style="zoom:50%;" /></p>
<p>整个数据报加密</p>
<p>然后整个加IP包头（R1 to R2）</p>
<h2 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h2><p><img src="https://gitee.com/fat1ger/picbed/raw/master/img/image-20250528182829932.png" alt="image-20250528182829932" style="zoom:50%;" /></p>
<p>互联网的路由器对目的地址是私有地址的IP 数据报一律不进行转发</p>
<p>10.0.0.0/8，即 10.0.0.0~10.255.255.255，相当于1个A类网络。
172.16.0.0/12，即 172.16.0.0~172.31.255.255，相当于 16 个连续的 B类网络。
192.168.0.0/16，即 192.168.0.0~192.168.255.255，相当于 256 个连续的C类网络。</p>
<p><img src="https://gitee.com/fat1ger/picbed/raw/master/img/image-20250528184545293.png" alt="image-20250528184545293" style="zoom:50%;" /></p>
<blockquote>
<p>路由器端口要占用一个ip地址</p>
</blockquote>
<p><img src="https://gitee.com/fat1ger/picbed/raw/master/img/image-20250528202856572.png" alt="image-20250528202856572"></p>
<p><img src="https://gitee.com/fat1ger/picbed/raw/master/img/image-20250528202917872.png" alt="image-20250528202917872"></p>
<p><img src="https://gitee.com/fat1ger/picbed/raw/master/img/image-20250530161049829.png" alt="image-20250530161049829" style="zoom:50%;" /></p>
<p><img src="https://gitee.com/fat1ger/picbed/raw/master/img/image-20250530161031425.png" alt="image-20250530161031425" style="zoom:50%;" /></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://seafoodfat1ger.github.io">Fat1ger</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://seafoodfat1ger.github.io/2025/05/27/network/Chapter4/">http://seafoodfat1ger.github.io/2025/05/27/network/Chapter4/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://seafoodfat1ger.github.io" target="_blank">水货不水</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/compter-network/">compter_network</a></div><div class="post_share"><div class="social-share" data-image="/img/Background.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2025/05/30/network/Chapter5/" title="Chapter5 传输层"><img class="cover" src="/img/Background.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Chapter5 传输层</div></div></a></div><div class="next-post pull-right"><a href="/2025/05/24/network/Chapter1/" title="Chapter1 概述"><img class="cover" src="/img/Background.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Chapter1 概述</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2025/05/24/network/Chapter1/" title="Chapter1 概述"><img class="cover" src="/img/Background.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-24</div><div class="title">Chapter1 概述</div></div></a></div><div><a href="/2025/05/23/network/Chapter2/" title="Chapter2 物理层"><img class="cover" src="/img/Background.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-23</div><div class="title">Chapter2 物理层</div></div></a></div><div><a href="/2025/05/24/network/Chapter3/" title="Chapter3 数据链路层"><img class="cover" src="/img/Background.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-24</div><div class="title">Chapter3 数据链路层</div></div></a></div><div><a href="/2025/05/30/network/Chapter5/" title="Chapter5 传输层"><img class="cover" src="/img/Background.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-30</div><div class="title">Chapter5 传输层</div></div></a></div><div><a href="/2025/05/31/network/Chapter6/" title="Chapter6 应用层"><img class="cover" src="/img/Background.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-31</div><div class="title">Chapter6 应用层</div></div></a></div><div><a href="/2025/06/01/network/Chapter7/" title="Chapter7 IPv6"><img class="cover" src="/img/Background.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2025-06-01</div><div class="title">Chapter7 IPv6</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/toux.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Fat1ger</div><div class="author-info__description">燕子不归春事晚,一汀烟雨杏花寒</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">38</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">5</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">5</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/SeafoodFat1ger"><i class="fab fa-github"></i><span>github地址</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Chapter4-%E7%BD%91%E7%BB%9C%E5%B1%82"><span class="toc-number">1.</span> <span class="toc-text">Chapter4 网络层</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#LINUX%EF%BC%9F"><span class="toc-number">1.1.</span> <span class="toc-text">LINUX？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%AC%E7%AB%A0%E9%87%8D%E7%82%B9"><span class="toc-number">1.2.</span> <span class="toc-text">本章重点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E5%B1%82%E7%9A%84%E5%8A%9F%E8%83%BD"><span class="toc-number">1.3.</span> <span class="toc-text">网络层的功能</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%82%E6%9E%84%E7%BD%91%E7%BB%9C%E4%BA%92%E8%81%94"><span class="toc-number">1.3.1.</span> <span class="toc-text">异构网络互联</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E4%B8%8E%E8%BD%AC%E5%8F%91"><span class="toc-number">1.3.2.</span> <span class="toc-text">路由与转发</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8B%A5%E5%A1%9E%E6%8E%A7%E5%88%B6"><span class="toc-number">1.3.3.</span> <span class="toc-text">拥塞控制</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BD%91%E9%99%85%E5%8D%8F%E8%AE%AEIP%E5%8F%8A%E9%85%8D%E5%A5%97%E5%8D%8F%E8%AE%AE"><span class="toc-number">1.3.4.</span> <span class="toc-text">网际协议IP及配套协议</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BD%91%E8%B7%AF%E5%B1%82%E6%8F%90%E4%BE%9B%E7%9A%84%E4%B8%A4%E7%A7%8D%E6%9C%8D%E5%8A%A1"><span class="toc-number">1.3.5.</span> <span class="toc-text">网路层提供的两种服务</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%99%9A%E7%94%B5%E8%B7%AF"><span class="toc-number">1.3.5.1.</span> <span class="toc-text">虚电路</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E6%8A%A5"><span class="toc-number">1.3.5.2.</span> <span class="toc-text">数据报</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#IPv4"><span class="toc-number">1.4.</span> <span class="toc-text">IPv4</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#IP%E6%95%B0%E6%8D%AE%E6%8A%A5%E7%9A%84%E6%A0%BC%E5%BC%8F"><span class="toc-number">1.4.1.</span> <span class="toc-text">IP数据报的格式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IP%E6%95%B0%E6%8D%AE%E6%8A%A5%E5%88%86%E7%89%87"><span class="toc-number">1.4.2.</span> <span class="toc-text">IP数据报分片</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IPv4%E5%9C%B0%E5%9D%80"><span class="toc-number">1.4.3.</span> <span class="toc-text">IPv4地址</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%92%E5%88%86%E5%AD%90%E7%BD%91%E5%92%8C%E6%9E%84%E9%80%A0%E8%B6%85%E7%BD%91"><span class="toc-number">1.5.</span> <span class="toc-text">划分子网和构造超网</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%90%E7%BD%91%E6%8E%A9%E7%A0%81"><span class="toc-number">1.5.1.</span> <span class="toc-text">子网掩码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E7%BB%84%E8%BD%AC%E5%8F%91"><span class="toc-number">1.5.2.</span> <span class="toc-text">分组转发</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%BB%98%E8%AE%A4%E7%BD%91%E5%85%B3"><span class="toc-number">1.5.3.</span> <span class="toc-text">默认网关</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A0%E5%88%86%E7%B1%BB%E5%9F%9F%E9%97%B4%E8%B7%AF%E7%94%B1-CIDR"><span class="toc-number">1.5.4.</span> <span class="toc-text">无分类域间路由 CIDR</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%93%88%E5%A4%AB%E6%9B%BC%E6%A0%91"><span class="toc-number">1.5.5.</span> <span class="toc-text">哈夫曼树</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9C%B0%E5%9D%80%E8%A7%A3%E6%9E%90%E5%8D%8F%E8%AE%AEARP"><span class="toc-number">1.6.</span> <span class="toc-text">地址解析协议ARP</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ARP%E5%8A%9F%E8%83%BD"><span class="toc-number">1.6.1.</span> <span class="toc-text">ARP功能</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86"><span class="toc-number">1.6.2.</span> <span class="toc-text">工作原理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E9%99%85%E6%8E%A7%E5%88%B6%E6%8A%A5%E6%96%87%E5%8D%8F%E8%AE%AEICMP"><span class="toc-number">1.7.</span> <span class="toc-text">网际控制报文协议ICMP</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ICMP%E6%8A%A5%E6%96%87%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.7.1.</span> <span class="toc-text">ICMP报文类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BA%94%E7%94%A8"><span class="toc-number">1.7.2.</span> <span class="toc-text">应用</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E7%AE%97%E6%B3%95%E4%B8%8E%E8%B7%AF%E7%94%B1%E5%8D%8F%E8%AE%AE"><span class="toc-number">1.8.</span> <span class="toc-text">路由算法与路由协议</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#RIP%E5%8D%8F%E8%AE%AE%E5%92%8C%E8%B7%9D%E7%A6%BB%E5%90%91%E9%87%8F%E8%B7%AF%E7%94%B1"><span class="toc-number">1.8.1.</span> <span class="toc-text">RIP协议和距离向量路由</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B7%9D%E7%A6%BB%E5%90%91%E9%87%8F%E8%B7%AF%E7%94%B1%E7%AE%97%E6%B3%95"><span class="toc-number">1.8.1.1.</span> <span class="toc-text">距离向量路由算法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E4%BF%A1%E6%81%AF%E5%8D%8F%E8%AE%AERIP"><span class="toc-number">1.8.1.2.</span> <span class="toc-text">路由信息协议RIP</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#OSPF%E5%8D%8F%E8%AE%AE%E5%92%8C%E9%93%BE%E8%B7%AF%E7%8A%B6%E6%80%81%E8%B7%AF%E7%94%B1"><span class="toc-number">1.8.2.</span> <span class="toc-text">OSPF协议和链路状态路由</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%93%BE%E8%B7%AF%E7%8A%B6%E6%80%81%E8%B7%AF%E7%94%B1%E7%AE%97%E6%B3%95"><span class="toc-number">1.8.2.1.</span> <span class="toc-text">链路状态路由算法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BC%80%E6%94%BE%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84%E4%BC%98%E5%85%88OSPF"><span class="toc-number">1.8.2.2.</span> <span class="toc-text">开放最短路径优先OSPF</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BGP%E5%92%8C%E8%B7%AF%E5%BE%84%E5%90%91%E9%87%8F%E8%B7%AF%E7%94%B1"><span class="toc-number">1.8.3.</span> <span class="toc-text">BGP和路径向量路由</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E5%B1%82%E8%AE%BE%E5%A4%87"><span class="toc-number">1.9.</span> <span class="toc-text">网络层设备</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%B2%E7%AA%81%E5%9F%9F%E5%92%8C%E5%B9%BF%E6%92%AD%E5%9F%9F"><span class="toc-number">1.9.1.</span> <span class="toc-text">冲突域和广播域</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E5%99%A8"><span class="toc-number">1.9.2.</span> <span class="toc-text">路由器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SDN%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="toc-number">1.9.3.</span> <span class="toc-text">SDN基本概念</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#IP%E7%BB%84%E6%92%AD"><span class="toc-number">1.10.</span> <span class="toc-text">IP组播</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E5%9C%B0%E5%9D%80%E8%BD%AC%E6%8D%A2NAT"><span class="toc-number">1.11.</span> <span class="toc-text">网络地址转换NAT</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E7%BD%91VPN"><span class="toc-number">1.12.</span> <span class="toc-text">虚拟专用网VPN</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE"><span class="toc-number">1.13.</span> <span class="toc-text">题目</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/06/01/network/Chapter8/" title="Chapter8 WLAN"><img src="/img/Background.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Chapter8 WLAN"/></a><div class="content"><a class="title" href="/2025/06/01/network/Chapter8/" title="Chapter8 WLAN">Chapter8 WLAN</a><time datetime="2025-06-01T11:30:14.000Z" title="发表于 2025-06-01 19:30:14">2025-06-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/06/01/network/Chapter7/" title="Chapter7 IPv6"><img src="/img/Background.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Chapter7 IPv6"/></a><div class="content"><a class="title" href="/2025/06/01/network/Chapter7/" title="Chapter7 IPv6">Chapter7 IPv6</a><time datetime="2025-06-01T07:30:14.000Z" title="发表于 2025-06-01 15:30:14">2025-06-01</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/05/31/network/Chapter6/" title="Chapter6 应用层"><img src="/img/Background.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Chapter6 应用层"/></a><div class="content"><a class="title" href="/2025/05/31/network/Chapter6/" title="Chapter6 应用层">Chapter6 应用层</a><time datetime="2025-05-31T13:30:14.000Z" title="发表于 2025-05-31 21:30:14">2025-05-31</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/05/30/network/Chapter5/" title="Chapter5 传输层"><img src="/img/Background.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Chapter5 传输层"/></a><div class="content"><a class="title" href="/2025/05/30/network/Chapter5/" title="Chapter5 传输层">Chapter5 传输层</a><time datetime="2025-05-30T06:30:14.000Z" title="发表于 2025-05-30 14:30:14">2025-05-30</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/05/27/network/Chapter4/" title="Chapter4 网络层"><img src="/img/Background.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Chapter4 网络层"/></a><div class="content"><a class="title" href="/2025/05/27/network/Chapter4/" title="Chapter4 网络层">Chapter4 网络层</a><time datetime="2025-05-27T06:30:14.000Z" title="发表于 2025-05-27 14:30:14">2025-05-27</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2024 - 2025 By Fat1ger</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">I wish you to become your own sun, no need to rely on who's light.<p><a target="_blank" href="https://hexo.io/"><img src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&logo=hexo" title="博客框架为Hexo"></a>&nbsp;<a target="_blank" href="https://butterfly.js.org/"><img src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&logo=bitdefender" title="主题采用butterfly"></a>&nbsp;<a target="_blank" href="https://www.jsdelivr.com/"><img src="https://img.shields.io/badge/CDN-jsDelivr-orange?style=flat&logo=jsDelivr" title="本站使用JsDelivr为静态资源提供CDN加速"></a> &nbsp;<a target="_blank" href="https://vercel.com/ "><img src="https://img.shields.io/badge/Hosted-Vervel-brightgreen?style=flat&logo=Vercel" title="本站采用双线部署，默认线路托管于Vercel"></a>&nbsp;<a target="_blank" href="https://vercel.com/ "><img src="https://img.shields.io/badge/Hosted-Coding-0cedbe?style=flat&logo=Codio" title="本站采用双线部署，联通线路托管于Coding"></a>&nbsp;<a target="_blank" href="https://github.com/"><img src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&logo=GitHub" title="本站项目由Gtihub托管"></a>&nbsp;<a target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&logo=Claris" title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"></a></p></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      tags: 'ams'
    },
    chtml: {
      scale: 1.1
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, '']
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typesetPromise()
}</script></div><script defer src="/js/cursor.js"></script><script async src="//at.alicdn.com/t/c/font_4046602_w4e3ixuz8in.js"></script><div class="aplayer no-destroy" data-id="3107471442" data-server="netease" data-type="playlist" data-fixed="true" data-autoplay="false"> </div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/metingjs/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener
  btf.removeGlobalFnEvent('pjax')
  btf.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>